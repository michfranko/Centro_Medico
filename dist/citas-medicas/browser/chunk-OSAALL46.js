import{$ as He,A as Re,Aa as Z,B as s,Ba as ge,C as i,Ca as ue,D as n,Da as fe,E as C,Ea as be,F as M,Fa as J,G as p,Ga as K,H as m,Ha as X,I as qe,J as Ue,K as Ge,N as me,O as r,P as f,Q as y,T as F,U as I,V as N,W as $e,X as W,Y as We,Z as V,_ as H,a as P,b as U,ba as Ye,c as De,ca as w,d as se,da as S,e as Le,ea as Y,f as ze,fa as Qe,ga as O,gb as nt,h as Te,j as je,ka as Ze,la as Je,lb as it,ma as pe,mb as ne,na as Ke,nb as A,o as g,oa as Xe,ob as j,p as u,pb as ie,qa as oe,qb as ot,ra as et,rb as rt,s as $,sa as D,sb as at,ta as x,u as d,ua as k,v as b,va as L,w as v,wa as tt,x as Be,xa as te,y as _,ya as z,z as E,za as Q}from"./chunk-Q3H77G3L.js";var ut=c=>({activo:c});function ft(c,t){if(c&1){let e=M();i(0,"div",13)(1,"label",14)(2,"input",15),p("change",function(){g(e);let a=m();return u(a.cerrarMenu())}),n(),C(3,"span")(4,"span")(5,"span"),n()()}if(c&2){let e=m();d(2),s("checked",e.isMenuOpen)}}function bt(c,t){if(c&1){let e=M();i(0,"aside",16)(1,"nav")(2,"ul")(3,"li")(4,"a",17),r(5,"Pacientes"),n()(),i(6,"li")(7,"a",18),r(8,"M\xE9dicos"),n()(),i(9,"li")(10,"a",19),r(11,"Administradores"),n()(),i(12,"li")(13,"a",20),r(14,"Agenda"),n()(),i(15,"li")(16,"a",21),r(17,"Solicitudes de Citas"),n()(),i(18,"li")(19,"a",22),r(20,"Historial de Citas"),n()(),i(21,"li")(22,"a",10),p("click",function(){g(e);let a=m();return u(a.logout())}),r(23,"Cerrar sesi\xF3n"),n()()()()()}}function _t(c,t){if(c&1&&(i(0,"div",23)(1,"strong"),r(2),n()()),c&2){let e=m();d(2),y("\u{1F514} Hay ",e.citasPendientesCount," cita(s) esperando resoluci\xF3n.")}}var _e=class c{constructor(t,e,o){this.authService=t;this.router=e;this.citasService=o;window.addEventListener("resize",this.resizeListener),this.citasSubscription=this.citasService.getCitas().subscribe(a=>{this.citasPendientesCount=(a||[]).filter(l=>l.estado==="pendiente").length})}isMenuOpen=!1;isDesktop=window.innerWidth>900;citasPendientesCount=0;resizeListener=()=>{this.isDesktop=window.innerWidth>900,this.isDesktop&&(this.isMenuOpen=!1)};citasSubscription;cerrarMenu(){this.isMenuOpen=!this.isMenuOpen}logout(){this.authService.logout().then(()=>{this.router.navigate(["/"])})}ngOnDestroy(){window.removeEventListener("resize",this.resizeListener),this.citasSubscription?.unsubscribe()}static \u0275fac=function(e){return new(e||c)(b(it),b(pe),b(ne))};static \u0275cmp=v({type:c,selectors:[["app-admin-dashboard"]],decls:30,vars:6,consts:[["class","topbar",4,"ngIf"],[1,"dashboard"],["class","sidebar","role","navigation",4,"ngIf"],["role","navigation","aria-label","Men\xFA principal",1,"mobile-menu",3,"ngClass"],["routerLink","pacientes","routerLinkActive","active",3,"click"],["routerLink","medicos","routerLinkActive","active",3,"click"],["routerLink","Admin","routerLinkActive","active",3,"click"],["routerLink","agenda","routerLinkActive","active",3,"click"],["routerLink","solicitudes-citas","routerLinkActive","active",3,"click"],["routerLink","historial-citas","routerLinkActive","active",3,"click"],[3,"click"],[1,"content"],["class","notificacion-citas-pendientes","role","alert","aria-live","polite",4,"ngIf"],[1,"topbar"],["for","burger",1,"burger"],["type","checkbox","id","burger",3,"change","checked"],["role","navigation",1,"sidebar"],["routerLink","pacientes","routerLinkActive","active"],["routerLink","medicos","routerLinkActive","active"],["routerLink","Admin","routerLinkActive","active"],["routerLink","agenda","routerLinkActive","active"],["routerLink","solicitudes-citas","routerLinkActive","active"],["routerLink","historial-citas","routerLinkActive","active"],["role","alert","aria-live","polite",1,"notificacion-citas-pendientes"]],template:function(e,o){e&1&&(_(0,ft,6,1,"div",0),i(1,"div",1),_(2,bt,24,0,"aside",2),i(3,"div",3)(4,"nav")(5,"ul")(6,"li")(7,"a",4),p("click",function(){return o.cerrarMenu()}),r(8,"Pacientes"),n()(),i(9,"li")(10,"a",5),p("click",function(){return o.cerrarMenu()}),r(11,"M\xE9dicos"),n()(),i(12,"li")(13,"a",6),p("click",function(){return o.cerrarMenu()}),r(14,"Administradores"),n()(),i(15,"li")(16,"a",7),p("click",function(){return o.cerrarMenu()}),r(17,"Agenda"),n()(),i(18,"li")(19,"a",8),p("click",function(){return o.cerrarMenu()}),r(20,"Solicitudes de Citas"),n()(),i(21,"li")(22,"a",9),p("click",function(){return o.cerrarMenu()}),r(23,"Historial de Citas"),n()(),i(24,"li")(25,"a",10),p("click",function(){return o.logout(),o.cerrarMenu()}),r(26,"Cerrar sesi\xF3n"),n()()()()(),i(27,"main",11),_(28,_t,3,1,"div",12),C(29,"router-outlet"),n()()),e&2&&(s("ngIf",!o.isDesktop),d(2),s("ngIf",o.isDesktop),d(),s("ngClass",We(4,ut,o.isMenuOpen)),d(25),s("ngIf",o.citasPendientesCount>0))},dependencies:[O,Ye,S,oe,Je,Ke,Xe,K],styles:[".dashboard[_ngcontent-%COMP%]{display:flex;height:100vh;overflow:hidden;position:relative}.sidebar[_ngcontent-%COMP%]{background-color:#2c3e50;color:#ecf0f1;width:240px;min-width:240px;padding:1rem;height:100vh;overflow-y:auto;position:fixed;top:0;left:0;flex-shrink:0;z-index:1000}.sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:1rem}.sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#ecf0f1;text-decoration:none;font-weight:600;display:block;padding:.5rem 1rem;border-radius:4px;transition:background-color .2s ease}.sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .sidebar[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#34495e}.content[_ngcontent-%COMP%]{flex-grow:1;width:100vw-240px;padding:1rem 2rem;margin-left:240px;overflow-y:auto;height:100vh;box-sizing:border-box}.topbar[_ngcontent-%COMP%]{background-color:#2c3e50;color:#fff;display:flex;padding:5px 0;align-items:center;height:56px;position:fixed;justify-content:center;width:100vw;top:0;left:0;z-index:1100;transition:top .2s cubic-bezier(.075,.82,.165,1)}.burger[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;display:flex;flex-direction:column;justify-content:space-between;height:20px;width:28px;padding:0}.burger[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;height:3px;background-color:#fff;border-radius:2px}.notificacion-citas-pendientes[_ngcontent-%COMP%]{background-color:#fffae6;border:1px solid #f5c518;color:#a67c00;padding:1rem;margin-bottom:1rem;border-radius:4px;font-weight:700}.burger[_ngcontent-%COMP%]{position:relative;width:40px;height:30px;background:transparent;cursor:pointer;display:block}.burger[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.burger[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;position:absolute;height:4px;width:100%;background:#fff;border-radius:9px;opacity:1;left:0;transform:rotate(0);transition:.25s ease-in-out}.burger[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-of-type(1){top:0;transform-origin:left center}.burger[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-of-type(2){top:50%;transform:translateY(-50%);transform-origin:left center}.burger[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-of-type(3){top:100%;transform-origin:left center;transform:translateY(-100%)}.burger[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ span[_ngcontent-%COMP%]:nth-of-type(1){transform:rotate(45deg);top:0;left:5px}.burger[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ span[_ngcontent-%COMP%]:nth-of-type(2){width:0%;opacity:0}.burger[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ span[_ngcontent-%COMP%]:nth-of-type(3){transform:rotate(-45deg);top:28px;left:5px}.mobile-menu[_ngcontent-%COMP%]{display:none}@media (max-width: 900px){.sidebar[_ngcontent-%COMP%]{display:none}.content[_ngcontent-%COMP%]{margin-left:0;padding-top:70px}.mobile-menu[_ngcontent-%COMP%]{display:block;position:fixed;top:-50vh;left:0;right:0;background-color:#2c3e50;color:#ecf0f1;max-height:calc(100vh - 56px);overflow-y:auto;z-index:1;box-shadow:0 4px 8px #0003;border-bottom-left-radius:6px;border-bottom-right-radius:6px;transition:top .4s cubic-bezier(.075,.82,.165,1)}.activo[_ngcontent-%COMP%]{top:56px}.mobile-menu[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:.5rem 0;margin:0}.mobile-menu[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin:.5rem 0}.mobile-menu[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#ecf0f1;text-decoration:none;font-weight:600;padding:1rem 1.5rem;display:block;transition:background-color .2s ease}.mobile-menu[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .mobile-menu[_ngcontent-%COMP%]   nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{background-color:#34495e}tr[_ngcontent-%COMP%]   .oculto[_ngcontent-%COMP%]{display:none}}"]})};function Ct(c,t){c&1&&(i(0,"div",11),r(1," Todos los campos deben estar completos para realizar el registro. "),n())}function ht(c,t){if(c&1&&(i(0,"label"),r(1,"Contrase\xF1a: "),C(2,"input",12),n()),c&2){let e=m();d(2),s("required",!(e.paciente!=null&&e.paciente.uid))}}var Ce=class c{constructor(t,e,o){this.fb=t;this.usuarioService=e;this.auth=o;this.form=this.fb.group({nombre:["",x.required],direccion:["",x.required],contacto:["",x.required],fechaNacimiento:["",x.required],email:["",[x.required,x.email]],password:[""]})}paciente=null;formSubmit=new E;cancelEdit=new E;isEditMode=!1;form;ngOnChanges(t){t.paciente&&this.paciente?(this.form.patchValue({nombre:this.paciente.nombre,direccion:this.paciente.direccion,contacto:this.paciente.contacto,fecha_nacimiento:this.paciente.fechaNacimiento||this.paciente.fechaNacimiento||"",email:this.paciente.email}),this.form.get("password")?.clearValidators(),this.form.get("password")?.updateValueAndValidity()):(this.form.reset(),this.form.get("password")?.setValidators(x.required),this.form.get("password")?.updateValueAndValidity())}onSubmit(){if(this.form.invalid){alert("Por favor completa todos los campos obligatorios.");return}let t=this.form.value;console.log("Formulario recibido:",t);let e="";if(t.fechaNacimiento){let o=new Date(t.fechaNacimiento);e=`${o.getFullYear()}-${(o.getMonth()+1).toString().padStart(2,"0")}-${o.getDate().toString().padStart(2,"0")}`}if(this.paciente&&this.paciente.uid){let o=U(P({},this.paciente),{nombre:t.nombre,direccion:t.direccion,contacto:t.contacto,fecha_nacimiento:e,email:t.email,rol:"paciente"}),a=this.paciente.id??this.paciente.uid;this.usuarioService.updateUsuario(Number(a),o).subscribe({next:()=>this.formSubmit.emit(),error:l=>{console.error("Error al actualizar paciente:",l),alert("Error al actualizar el paciente.")}})}else{let o={nombre:t.nombre,direccion:t.direccion,contacto:t.contacto,fecha_nacimiento:e,email:t.email,password:t.password,rol:"paciente"};this.usuarioService.createUsuario(o).subscribe({next:()=>{alert("Paciente registrado exitosamente."),this.formSubmit.emit(),this.form.reset()},error:a=>{console.error("Error al guardar en backend:",a),alert("Error al registrar el paciente en el backend.")}})}}cancelar(){window.location.reload()}static \u0275fac=function(e){return new(e||c)(b(J),b(A),b(nt))};static \u0275cmp=v({type:c,selectors:[["app-paciente-form"]],inputs:{paciente:"paciente",isEditMode:"isEditMode"},outputs:{formSubmit:"formSubmit",cancelEdit:"cancelEdit"},features:[$],decls:25,vars:7,consts:[[1,"paciente-form",3,"ngSubmit","formGroup"],["class","error-message",4,"ngIf"],["formControlName","nombre","type","text"],["formControlName","direccion","type","text"],["formControlName","contacto","type","text"],["formControlName","fechaNacimiento","type","date"],["formControlName","email","type","email",3,"readonly"],[4,"ngIf"],[1,"buttons"],["type","submit",3,"disabled"],["type","button",3,"click"],[1,"error-message"],["formControlName","password","type","password",3,"required"]],template:function(e,o){e&1&&(i(0,"form",0),p("ngSubmit",function(){return o.onSubmit()}),i(1,"h3"),r(2),n(),_(3,Ct,2,0,"div",1),i(4,"label"),r(5,"Nombre: "),C(6,"input",2),n(),i(7,"label"),r(8,"Direcci\xF3n: "),C(9,"input",3),n(),i(10,"label"),r(11,"Contacto: "),C(12,"input",4),n(),i(13,"label"),r(14,"Fecha de Nacimiento: "),C(15,"input",5),n(),i(16,"label"),r(17,"Email: "),C(18,"input",6),n(),_(19,ht,3,1,"label",7),i(20,"div",8)(21,"button",9),r(22),n(),i(23,"button",10),p("click",function(){return o.cancelar()}),r(24,"Cancelar"),n()()()),e&2&&(s("formGroup",o.form),d(2),y("",o.paciente!=null&&o.paciente.uid?"Editar":"Registrar"," Paciente"),d(),s("ngIf",o.form.invalid&&o.form.touched),d(15),s("readonly",o.isEditMode),d(),s("ngIf",!o.isEditMode),d(2),s("disabled",o.form.invalid),d(),y(" ",o.paciente!=null&&o.paciente.uid?"Actualizar":"Registrar"," "))},dependencies:[O,S,X,z,D,k,L,be,Q,Z],styles:[".container[_ngcontent-%COMP%]{max-width:900px;margin:2rem auto;padding:1rem 2rem;background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;color:#333;box-sizing:border-box}h2[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-weight:600;color:#2c3e50;text-align:center}.paciente-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1.5rem;background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 5px #0000001a}.paciente-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#2980b9;color:#fff}.paciente-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .paciente-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #ddd;text-align:left;font-size:.95rem;word-wrap:break-word;vertical-align:middle}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.paciente-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;border:none;padding:.4rem .8rem;color:#fff;font-size:.85rem;border-radius:4px;cursor:pointer;margin-right:.5rem;transition:background-color .2s ease-in-out;white-space:nowrap}.paciente-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#1d6fa5}form[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem 2rem;justify-content:space-between;background:#ecf0f1;padding:1rem 1.5rem;border-radius:8px;box-shadow:inset 0 0 5px #0000000d;margin-bottom:2rem;margin-left:auto;margin-right:auto;box-sizing:border-box}form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1 1 45%;display:flex;flex-direction:column}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.3rem;color:#34495e}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem .8rem;font-size:1rem;border:1px solid #bdc3c7;border-radius:4px;transition:border-color .2s ease-in-out}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#2980b9;box-shadow:0 0 4px #2980b9aa}form[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:.85rem;margin-top:.2rem}form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{flex-basis:100%;display:flex;justify-content:flex-end;gap:1rem;margin-top:.5rem}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#27ae60;border:none;padding:.6rem 1.2rem;color:#fff;font-size:1rem;border-radius:4px;cursor:pointer;transition:background-color .2s ease-in-out}form[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]{background-color:#c0392b}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#219150}form[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]:hover{background-color:#962d22}@media (max-width: 768px){form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1 1 100%}.paciente-table[_ngcontent-%COMP%]{border:0;box-shadow:none}.paciente-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:1rem;background-color:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a;padding:1rem}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0;text-align:left;border:none;border-bottom:1px solid #eee;position:relative;font-size:.9rem}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-bottom:0;padding-top:.75rem}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label);flex-basis:40%;font-weight:600;color:#555;padding-right:1rem;white-space:nowrap}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[data-label=Acciones][_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:flex-start}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[data-label=Acciones][_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.5rem;font-size:.9rem;margin-right:0}.paciente-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .paciente-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.85rem}.paciente-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.3rem .6rem;font-size:.75rem}}",".paciente-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;max-width:400px;margin-bottom:20px}label[_ngcontent-%COMP%]{display:flex;flex-direction:column}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.error-message[_ngcontent-%COMP%]{color:red;margin-bottom:10px}"]})};function Mt(c,t){if(c&1){let e=M();i(0,"button",4),p("click",function(){g(e);let a=m().$implicit,l=m();return u(l.deletePaciente(a.id))}),r(1,"Eliminar"),n()}}function xt(c,t){if(c&1){let e=M();i(0,"tr")(1,"td"),r(2),n(),i(3,"td"),r(4),n(),i(5,"td"),r(6),n(),i(7,"td"),r(8),n(),i(9,"td"),r(10),n(),i(11,"td")(12,"button",4),p("click",function(){let a=g(e).$implicit,l=m();return u(l.editPaciente(a))}),r(13,"Editar"),n(),_(14,Mt,2,0,"button",5),n()()}if(c&2){let e=t.$implicit;d(2),f(e.nombre),d(2),f(e.direccion),d(2),f(e.fechaNacimiento),d(2),f(e.email),d(2),f(e.contacto),d(4),s("ngIf",e.id!==void 0)}}var he=class c{constructor(t){this.usuarioService=t}pacientes$;selectedPaciente=null;isEditMode=!1;ngOnInit(){this.loadPacientes()}loadPacientes(){this.pacientes$=this.usuarioService.getPacientes()}editPaciente(t){this.selectedPaciente=P({},t),this.isEditMode=!0}deletePaciente(t){if(confirm("\xBFEst\xE1s seguro de eliminar este paciente?")){if(!t||isNaN(Number(t))){alert("ID de paciente inv\xE1lido. No se puede eliminar.");return}this.usuarioService.deleteUsuario(t).subscribe({next:()=>this.loadPacientes(),error:()=>alert("Error al eliminar el paciente.")})}}handleFormSubmit(){this.selectedPaciente=null,this.isEditMode=!1,this.loadPacientes()}static \u0275fac=function(e){return new(e||c)(b(A))};static \u0275cmp=v({type:c,selectors:[["app-paciente-list"]],decls:22,vars:5,consts:[[1,"container"],[3,"formSubmit","cancelEdit","paciente","isEditMode"],[1,"paciente-table"],[4,"ngFor","ngForOf"],[3,"click"],[3,"click",4,"ngIf"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"h2"),r(2,"Pacientes Registrados"),n(),i(3,"app-paciente-form",1),p("formSubmit",function(){return o.handleFormSubmit()})("cancelEdit",function(){return o.selectedPaciente=null,o.isEditMode=!1}),n(),i(4,"table",2)(5,"thead")(6,"tr")(7,"th"),r(8,"Nombre"),n(),i(9,"th"),r(10,"Direccion"),n(),i(11,"th"),r(12,"Fecha Nacimiento"),n(),i(13,"th"),r(14,"Email"),n(),i(15,"th"),r(16,"Contacto"),n(),i(17,"th"),r(18,"Acciones"),n()()(),i(19,"tbody"),_(20,xt,15,6,"tr",3),V(21,"async"),n()()()),e&2&&(d(3),s("paciente",o.selectedPaciente)("isEditMode",o.isEditMode),d(17),s("ngForOf",H(21,3,o.pacientes$)))},dependencies:[O,w,S,Y,Ce],styles:[".container[_ngcontent-%COMP%]{max-width:900px;margin:2rem auto;padding:1rem 2rem;background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;color:#333;box-sizing:border-box}h2[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-weight:600;color:#2c3e50;text-align:center}.paciente-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1.5rem;background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 5px #0000001a}.paciente-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#2980b9;color:#fff}.paciente-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .paciente-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #ddd;text-align:left;font-size:.95rem;word-wrap:break-word;vertical-align:middle}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.paciente-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;border:none;padding:.4rem .8rem;color:#fff;font-size:.85rem;border-radius:4px;cursor:pointer;margin-right:.5rem;transition:background-color .2s ease-in-out;white-space:nowrap}.paciente-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#1d6fa5}form[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem 2rem;justify-content:space-between;background:#ecf0f1;padding:1rem 1.5rem;border-radius:8px;box-shadow:inset 0 0 5px #0000000d;margin-bottom:2rem;margin-left:auto;margin-right:auto;box-sizing:border-box}form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1 1 45%;display:flex;flex-direction:column}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.3rem;color:#34495e}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem .8rem;font-size:1rem;border:1px solid #bdc3c7;border-radius:4px;transition:border-color .2s ease-in-out}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#2980b9;box-shadow:0 0 4px #2980b9aa}form[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:.85rem;margin-top:.2rem}form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{flex-basis:100%;display:flex;justify-content:flex-end;gap:1rem;margin-top:.5rem}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#27ae60;border:none;padding:.6rem 1.2rem;color:#fff;font-size:1rem;border-radius:4px;cursor:pointer;transition:background-color .2s ease-in-out}form[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]{background-color:#c0392b}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#219150}form[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]:hover{background-color:#962d22}@media (max-width: 768px){form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1 1 100%}.paciente-table[_ngcontent-%COMP%]{border:0;box-shadow:none}.paciente-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:1rem;background-color:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a;padding:1rem}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0;text-align:left;border:none;border-bottom:1px solid #eee;position:relative;font-size:.9rem}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-bottom:0;padding-top:.75rem}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label);flex-basis:40%;font-weight:600;color:#555;padding-right:1rem;white-space:nowrap}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[data-label=Acciones][_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:flex-start}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[data-label=Acciones][_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;padding:.5rem;font-size:.9rem;margin-right:0}.paciente-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .paciente-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.85rem}.paciente-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.3rem .6rem;font-size:.75rem}}"]})};function vt(c,t){if(c&1){let e=M();i(0,"button",10),p("click",function(){g(e);let a=m();return u(a.cancelEdit.emit())}),r(1,"Cancelar"),n()}}var Me=class c{constructor(t,e){this.fb=t;this.medicoService=e;this.form=this.fb.group({nombre:["",x.required],especialidad:["",x.required],contacto:["",x.required],direccion:["",x.required]})}medico=null;formSubmit=new E;cancelEdit=new E;form;ngOnChanges(t){t.medico&&this.medico?this.form.patchValue(this.medico):this.form.reset()}onSubmit(){let t=P({},this.form.value);this.medico?.id?(t.id=this.medico.id,this.medicoService.updateMedico(Number(t.id),t).subscribe({next:()=>this.formSubmit.emit(),error:()=>alert("Error al actualizar el m\xE9dico.")})):this.medicoService.addMedico(t).subscribe({next:()=>{this.form.reset(),this.formSubmit.emit()},error:()=>alert("Error al agregar el m\xE9dico.")})}static \u0275fac=function(e){return new(e||c)(b(J),b(j))};static \u0275cmp=v({type:c,selectors:[["app-medico-form"]],inputs:{medico:"medico"},outputs:{formSubmit:"formSubmit",cancelEdit:"cancelEdit"},features:[$],decls:24,vars:5,consts:[[1,"container"],[3,"ngSubmit","formGroup"],[1,"form-group"],["formControlName","nombre","type","text","required","",1,"form-control"],["formControlName","especialidad","type","text","required","",1,"form-control"],["formControlName","contacto","type","text","required","",1,"form-control"],["formControlName","direccion","type","text","required","",1,"form-control"],[1,"buttons"],["type","submit",3,"disabled"],["type","button","class","cancel-btn",3,"click",4,"ngIf"],["type","button",1,"cancel-btn",3,"click"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"h2"),r(2),n(),i(3,"form",1),p("ngSubmit",function(){return o.onSubmit()}),i(4,"div",2)(5,"label"),r(6,"Nombre:"),n(),C(7,"input",3),n(),i(8,"div",2)(9,"label"),r(10,"Especialidad:"),n(),C(11,"input",4),n(),i(12,"div",2)(13,"label"),r(14,"Contacto:"),n(),C(15,"input",5),n(),i(16,"div",2)(17,"label"),r(18,"Direcci\xF3n:"),n(),C(19,"input",6),n(),i(20,"div",7)(21,"button",8),r(22),n(),_(23,vt,2,0,"button",9),n()()()),e&2&&(d(2),f(o.medico!=null&&o.medico.id?"Editar M\xE9dico":"Registrar M\xE9dico"),d(),s("formGroup",o.form),d(18),s("disabled",o.form.invalid),d(),y(" ",o.medico!=null&&o.medico.id?"Actualizar":"Agregar"," "),d(),s("ngIf",o.medico==null?null:o.medico.id))},dependencies:[O,S,X,z,D,k,L,be,Q,Z],styles:[".container[_ngcontent-%COMP%]{margin:2rem auto;padding:1rem 2rem;background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;color:#333}h2[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-weight:600;color:#2c3e50;text-align:center}.paciente-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1.5rem}.paciente-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#2980b9;color:#fff}.paciente-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .paciente-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #ddd;text-align:left;font-size:.95rem}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.paciente-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;border:none;padding:.4rem .8rem;color:#fff;font-size:.85rem;border-radius:4px;cursor:pointer;margin-right:.5rem;transition:background-color .2s ease-in-out}.paciente-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#1d6fa5}form[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem 2rem;justify-content:space-between;background:#ecf0f1;padding:1rem 1.5rem;border-radius:8px;box-shadow:inset 0 0 5px #0000000d;margin-bottom:2rem}form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1 1 45%;display:flex;flex-direction:column}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.3rem;color:#34495e}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem .8rem;font-size:1rem;border:1px solid #bdc3c7;border-radius:4px;transition:border-color .2s ease-in-out}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#2980b9;box-shadow:0 0 4px #2980b9aa}form[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:.85rem;margin-top:.2rem}form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{flex-basis:100%;display:flex;justify-content:flex-end;gap:1rem;margin-top:.5rem}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#27ae60;border:none;padding:.6rem 1.2rem;color:#fff;font-size:1rem;border-radius:4px;cursor:pointer;transition:background-color .2s ease-in-out}form[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]{background-color:#c0392b}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#219150}form[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]:hover{background-color:#962d22}form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1 1 100%}.paciente-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .paciente-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.85rem}.paciente-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.3rem .6rem;font-size:.75rem}.medico-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1.5rem}.medico-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#27ae60;color:#fff}.medico-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .medico-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #ddd;text-align:left;font-size:.95rem}.medico-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.medico-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;border:none;padding:.4rem .8rem;color:#fff;font-size:.85rem;border-radius:4px;cursor:pointer;margin-right:.5rem;transition:background-color .2s ease-in-out}.medico-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#1d6fa5}@media (max-width: 950px){.oculto[_ngcontent-%COMP%]{display:none}.acciones-boton[_ngcontent-%COMP%]{display:flex;flex-direction:column}.acciones-boton[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:3px 0}}"]})};function Ot(c,t){if(c&1){let e=M();i(0,"tr")(1,"td"),r(2),n(),i(3,"td"),r(4),n(),i(5,"td"),r(6),n(),i(7,"td",4)(8,"button",5),p("click",function(){let a=g(e).$implicit,l=m();return u(l.editMedico(a))}),r(9,"Editar"),n(),i(10,"button",5),p("click",function(){let a=g(e).$implicit,l=m();return u(a.id&&l.deleteMedico(a.id))}),r(11,"Eliminar"),n()()()}if(c&2){let e=t.$implicit;d(2),f(e.nombre),d(2),f(e.especialidad),d(2),f(e.contacto)}}var ve=class c{constructor(t){this.medicoService=t}medicos$;selectedMedico=null;ngOnInit(){this.medicos$=this.medicoService.getMedicos()}editMedico(t){this.selectedMedico=P({},t)}deleteMedico(t){confirm("\xBFEst\xE1s seguro de eliminar este m\xE9dico?")&&this.medicoService.deleteMedico(Number(t)).subscribe({next:()=>{},error:()=>alert("Error al eliminar el m\xE9dico.")})}handleFormSubmit(t){this.selectedMedico=null,this.medicos$=this.medicoService.getMedicos()}static \u0275fac=function(e){return new(e||c)(b(j))};static \u0275cmp=v({type:c,selectors:[["app-medico-list"]],decls:16,vars:4,consts:[[1,"container"],[3,"formSubmit","cancelEdit","medico"],[1,"medico-table"],[4,"ngFor","ngForOf"],[1,"acciones-boton"],[3,"click"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"app-medico-form",1),p("formSubmit",function(l){return o.handleFormSubmit(l)})("cancelEdit",function(){return o.selectedMedico=null}),n(),i(2,"table",2)(3,"thead")(4,"tr")(5,"th"),r(6,"Nombre"),n(),i(7,"th"),r(8,"Especialidad"),n(),i(9,"th"),r(10,"Contacto"),n(),i(11,"th"),r(12,"Acciones"),n()()(),i(13,"tbody"),_(14,Ot,12,3,"tr",3),V(15,"async"),n()()()),e&2&&(d(),s("medico",o.selectedMedico),d(13),s("ngForOf",H(15,2,o.medicos$)))},dependencies:[O,w,Y,Me],styles:[".container[_ngcontent-%COMP%]{margin:2rem auto;padding:1rem 2rem;background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;color:#333}h2[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-weight:600;color:#2c3e50;text-align:center}.paciente-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1.5rem}.paciente-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#2980b9;color:#fff}.paciente-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .paciente-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #ddd;text-align:left;font-size:.95rem}.paciente-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.paciente-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;border:none;padding:.4rem .8rem;color:#fff;font-size:.85rem;border-radius:4px;cursor:pointer;margin-right:.5rem;transition:background-color .2s ease-in-out}.paciente-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#1d6fa5}form[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem 2rem;justify-content:space-between;background:#ecf0f1;padding:1rem 1.5rem;border-radius:8px;box-shadow:inset 0 0 5px #0000000d;margin-bottom:2rem}form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1 1 45%;display:flex;flex-direction:column}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.3rem;color:#34495e}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem .8rem;font-size:1rem;border:1px solid #bdc3c7;border-radius:4px;transition:border-color .2s ease-in-out}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#2980b9;box-shadow:0 0 4px #2980b9aa}form[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:.85rem;margin-top:.2rem}form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{flex-basis:100%;display:flex;justify-content:flex-end;gap:1rem;margin-top:.5rem}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#27ae60;border:none;padding:.6rem 1.2rem;color:#fff;font-size:1rem;border-radius:4px;cursor:pointer;transition:background-color .2s ease-in-out}form[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]{background-color:#c0392b}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#219150}form[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]:hover{background-color:#962d22}form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1 1 100%}.paciente-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .paciente-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:.85rem}.paciente-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.3rem .6rem;font-size:.75rem}.medico-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1.5rem}.medico-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#27ae60;color:#fff}.medico-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .medico-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #ddd;text-align:left;font-size:.95rem}.medico-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.medico-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;border:none;padding:.4rem .8rem;color:#fff;font-size:.85rem;border-radius:4px;cursor:pointer;margin-right:.5rem;transition:background-color .2s ease-in-out}.medico-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#1d6fa5}@media (max-width: 950px){.oculto[_ngcontent-%COMP%]{display:none}.acciones-boton[_ngcontent-%COMP%]{display:flex;flex-direction:column}.acciones-boton[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:3px 0}}"]})};var Pt=["calendar"],ce=()=>({standalone:!0});function St(c,t){if(c&1&&(i(0,"option",15),r(1),n()),c&2){let e=t.$implicit;s("value",e.id),d(),y(" ",e.nombre," ")}}function yt(c,t){if(c&1&&(i(0,"div",16),r(1),n()),c&2){let e=m(2);d(),f(e.mensajeError)}}function wt(c,t){if(c&1&&(i(0,"div",16),r(1),n()),c&2){let e=m(2);d(),f(e.errorPadre)}}function Et(c,t){if(c&1){let e=M();i(0,"div")(1,"form",2),p("ngSubmit",function(){g(e);let a=m();return u(a.guardar())}),i(2,"div",3)(3,"label"),r(4,"M\xE9dico"),n(),i(5,"select",4),p("change",function(a){g(e);let l=m();return u(l.onMedicoChange(a))}),_(6,St,2,2,"option",5),n()(),i(7,"div",3)(8,"label"),r(9,"Fecha"),n(),C(10,"input",6),n(),i(11,"div",3)(12,"label"),r(13,"Hora de Inicio"),n(),C(14,"input",7),n(),i(15,"div",3)(16,"label"),r(17,"Hora de Fin"),n(),C(18,"input",8),n(),i(19,"div",9),C(20,"input",10),i(21,"label",11),r(22,"Disponible"),n()(),_(23,yt,2,1,"div",12)(24,wt,2,1,"div",12),i(25,"button",13),r(26,"Guardar"),n(),i(27,"button",14),p("click",function(){g(e);let a=m();return u(a.cancelar())}),r(28,"Cancelar"),n()()()}if(c&2){let e=m();d(),s("formGroup",e.formAgenda),d(5),s("ngForOf",e.medicos),d(4),s("min",e.minDate),d(13),s("ngIf",e.mensajeError),d(),s("ngIf",e.errorPadre),d(),s("disabled",e.formAgenda.invalid)}}function kt(c,t){if(c&1&&(i(0,"option",15),r(1),n()),c&2){let e=t.$implicit;s("value",e.id),d(),y(" ",e.nombre," ")}}function At(c,t){if(c&1){let e=M();i(0,"label",29)(1,"input",30),N("ngModelChange",function(a){let l=g(e).index,h=m(2);return I(h.diasSeleccionados[l],a)||(h.diasSeleccionados[l]=a),u(a)}),n(),i(2,"span"),r(3),n()()}if(c&2){let e=t.$implicit,o=t.index,a=m(2);d(),s("name",$e("dia",o)),F("ngModel",a.diasSeleccionados[o]),s("ngModelOptions",W(5,ce)),d(2),f(e)}}function Ft(c,t){if(c&1&&(i(0,"div",16),r(1),n()),c&2){let e=m(2);d(),f(e.mensajeError)}}function It(c,t){if(c&1&&(i(0,"div",16),r(1),n()),c&2){let e=m(2);d(),f(e.errorPadre)}}function Nt(c,t){if(c&1){let e=M();i(0,"div")(1,"form",2),p("ngSubmit",function(){g(e);let a=m();return u(a.guardar())}),i(2,"div",3)(3,"label"),r(4,"M\xE9dico"),n(),i(5,"select",4),p("change",function(a){g(e);let l=m();return u(l.onMedicoChange(a))}),_(6,kt,2,2,"option",5),n()(),i(7,"div",17)(8,"label",18),r(9,"D\xEDas de la semana:"),n(),i(10,"div",19),_(11,At,4,6,"label",20),n()(),i(12,"div",21)(13,"label"),r(14,"Fecha de inicio:"),n(),i(15,"input",22),N("ngModelChange",function(a){g(e);let l=m();return I(l.fechaInicioMes,a)||(l.fechaInicioMes=a),u(a)}),n()(),i(16,"div",21)(17,"label"),r(18,"Fecha de fin:"),n(),i(19,"input",23),N("ngModelChange",function(a){g(e);let l=m();return I(l.fechaFinMes,a)||(l.fechaFinMes=a),u(a)}),n()(),i(20,"div",21)(21,"label"),r(22,"Hora de inicio:"),n(),i(23,"input",24),N("ngModelChange",function(a){g(e);let l=m();return I(l.horaInicioBloque,a)||(l.horaInicioBloque=a),u(a)}),n()(),i(24,"div",21)(25,"label"),r(26,"Hora de fin:"),n(),i(27,"input",25),N("ngModelChange",function(a){g(e);let l=m();return I(l.horaFinBloque,a)||(l.horaFinBloque=a),u(a)}),n()(),i(28,"div",26),C(29,"input",10),i(30,"label",11),r(31,"Disponible"),n()(),_(32,Ft,2,1,"div",12)(33,It,2,1,"div",12),i(34,"button",27),r(35,"Crear agendas"),n(),i(36,"button",28),p("click",function(){g(e);let a=m();return u(a.cancelar())}),r(37,"Cancelar"),n()()()}if(c&2){let e=m();d(),s("formGroup",e.formAgenda),d(5),s("ngForOf",e.medicos),d(5),s("ngForOf",e.diasSemana),d(4),F("ngModel",e.fechaInicioMes),s("ngModelOptions",W(14,ce))("min",e.minDate),d(4),F("ngModel",e.fechaFinMes),s("ngModelOptions",W(15,ce)),d(4),F("ngModel",e.horaInicioBloque),s("ngModelOptions",W(16,ce)),d(4),F("ngModel",e.horaFinBloque),s("ngModelOptions",W(17,ce)),d(5),s("ngIf",e.mensajeError),d(),s("ngIf",e.errorPadre)}}function Tt(c,t){if(c&1&&(i(0,"option",15),r(1),n()),c&2){let e=t.$implicit;s("value",e.id),d(),y(" ",e.nombre," ")}}function Vt(c,t){if(c&1&&(i(0,"div",16),r(1),n()),c&2){let e=m(2);d(),f(e.mensajeError)}}function Dt(c,t){if(c&1&&(i(0,"div",16),r(1),n()),c&2){let e=m(2);d(),f(e.errorPadre)}}function Lt(c,t){if(c&1){let e=M();i(0,"div")(1,"form",2),p("ngSubmit",function(){g(e);let a=m();return u(a.guardar())}),i(2,"div",3)(3,"label"),r(4,"M\xE9dico"),n(),i(5,"select",4),p("change",function(a){g(e);let l=m();return u(l.onMedicoChange(a))}),_(6,Tt,2,2,"option",5),n()(),i(7,"div",3)(8,"label"),r(9,"Fecha"),n(),C(10,"input",31),n(),i(11,"div",3)(12,"label"),r(13,"Hora de Inicio"),n(),C(14,"input",7),n(),i(15,"div",3)(16,"label"),r(17,"Hora de Fin"),n(),C(18,"input",8),n(),i(19,"div",9),C(20,"input",10),i(21,"label",11),r(22,"Disponible"),n()(),_(23,Vt,2,1,"div",12)(24,Dt,2,1,"div",12),i(25,"button",13),r(26,"Guardar Cambios"),n(),i(27,"button",14),p("click",function(){g(e);let a=m();return u(a.cancelar())}),r(28,"Cancelar"),n()()()}if(c&2){let e=m();d(),s("formGroup",e.formAgenda),d(5),s("ngForOf",e.medicos),d(17),s("ngIf",e.mensajeError),d(),s("ngIf",e.errorPadre),d(),s("disabled",e.formAgenda.invalid)}}var Oe=class c{constructor(t,e,o){this.fb=t;this.agendaService=e;this.ngZone=o;let a=new Date,l=new Date(a);l.setDate(l.getDate()+1),this.minDate=l.toISOString().split("T")[0]}agenda;medicos=[];errorPadre="";onSave=new E;onCancel=new E;onError=new E;formAgenda;mensajeError="";selectedMedicoId="";selectedDates=[];isRecurring=!1;recurringDays=[];editingAgenda=null;agendasMedico=[];menuOpcion="unitaria";recurrenciaTipo="dia";fechaInicioMes="";fechaFinMes="";fechaHora="";horaInicioBloque="";horaFinBloque="";duracionBloque=30;diasSemana=["Lunes","Martes","Mi\xE9rcoles","Jueves","Viernes","S\xE1bado","Domingo"];diasSeleccionados=[!1,!1,!1,!1,!1,!1,!1];calendarDiv;calendar;minDate;ngOnInit(){this.formAgenda=this.fb.group({uidMedico:["",x.required],fecha:["",x.required],horaInicio:["",x.required],horaFin:["",x.required],disponible:[!0],isRecurring:[!1],recurringDays:[[]],fechasMultiples:[[]]}),this.updateCalendarEvents()}ngAfterViewInit(){this.initCalendar()}ngOnChanges(){this.agenda&&this.formAgenda&&this.formAgenda.patchValue({uidMedico:this.agenda.uidMedico,fecha:this.agenda.fecha,horaInicio:this.agenda.horaInicio,horaFin:this.agenda.horaFin,disponible:this.agenda.disponible}),this.selectedMedicoId&&this.cargarAgendasMedico(this.selectedMedicoId),this.updateCalendarEvents()}onMedicoChange(t){let o=t.target.value;this.selectedMedicoId=o,this.cargarAgendasMedico(o),setTimeout(()=>{this.destroyAndReinitCalendar()},0)}cargarAgendasMedico(t){this.agendaService.getAgendasByMedico(Number(t)).subscribe(e=>{this.agendasMedico=e,this.updateCalendarEvents()})}seleccionarFecha(t){this.selectedDates.find(e=>e.getTime()===t.getTime())||this.selectedDates.push(t)}quitarFecha(t){this.selectedDates=this.selectedDates.filter(e=>e.getTime()!==t.getTime())}agregarFecha(t){let e=t.target.value;e&&!this.selectedDates.find(o=>o.toISOString().split("T")[0]===e)&&this.selectedDates.push(new Date(e))}guardar(){return se(this,null,function*(){this.mensajeError="";let t=new Date;if(t.setHours(0,0,0,0),this.menuOpcion==="actualizacion"&&this.editingAgenda){if(this.formAgenda.valid){let e=this.formAgenda.value,o=this.medicos.find(h=>h.id===e.uidMedico),a=o?o.nombre:"Sin asignar",l=U(P({},e),{medico:o,medicoNombre:a});if(l.id)yield this.agendaService.updateAgenda(Number(l.id),l).toPromise();else{this.mensajeError="No se puede actualizar: ID de agenda no v\xE1lido.";return}this.onSave.emit(l),this.cargarAgendasMedico(e.uidMedico),this.editingAgenda=null,setTimeout(()=>{this.destroyAndReinitCalendar()},0)}return}if(this.menuOpcion==="completa"){let e=this.formAgenda.value,o=this.medicos.find(l=>l.id===e.uidMedico),a=o?o.nombre:"Sin asignar";if(this.fechaInicioMes&&this.fechaFinMes&&this.horaInicioBloque&&this.horaFinBloque){let l=this.diasSeleccionados.map((G,Fe)=>G?Fe:-1).filter(G=>G!==-1);if(l.length===0){this.mensajeError="Selecciona al menos un d\xEDa de la semana.";return}let h=new Date(this.fechaInicioMes);if(new Date(h.getUTCFullYear(),h.getUTCMonth(),h.getUTCDate())<=t){this.mensajeError="La fecha de inicio debe ser posterior a la fecha actual.";return}let ke=new Date(this.fechaFinMes),Ve=0,Ae=0;for(;h<=ke;){let G=h.getDay();if(G=G===0?6:G-1,l.includes(G)){let[Fe,st]=this.horaInicioBloque.split(":").map(Number),[mt,pt]=this.horaFinBloque.split(":").map(Number),Ie=Fe*60+st,Ne=mt*60+pt;if(Ie>=Ne){this.mensajeError="La hora de inicio debe ser menor que la hora de fin.";return}let de=this.padTime(Math.floor(Ie/60))+":"+this.padTime(Ie%60),le=this.padTime(Math.floor(Ne/60))+":"+this.padTime(Ne%60);if(((yield this.agendaService.getAgendasByMedico(Number(e.uidMedico)).toPromise())||[]).some(q=>q.fecha===h.toISOString().split("T")[0]&&(de>=q.horaInicio&&de<q.horaFin||le>q.horaInicio&&le<=q.horaFin||de<=q.horaInicio&&le>=q.horaFin)))Ae++;else{let q={uidMedico:e.uidMedico,fecha:h.toISOString().split("T")[0],horaInicio:de,horaFin:le,disponible:e.disponible,medicoNombre:a};yield this.agendaService.addAgenda(q).toPromise(),Ve++}}h.setDate(h.getDate()+1)}if(Ve===0){this.mensajeError="No se pudo crear ninguna agenda (todas solapan con agendas existentes).";return}Ae>0&&(this.mensajeError=`${Ae} agendas no se crearon por solapamiento.`)}this.cargarAgendasMedico(e.uidMedico),setTimeout(()=>{this.destroyAndReinitCalendar()},0),this.selectedDates=[],this.fechaInicioMes="",this.fechaFinMes="",this.horaInicioBloque="",this.horaFinBloque="",this.diasSeleccionados=[!1,!1,!1,!1,!1,!1,!1];return}else if(this.formAgenda.valid){let e=this.formAgenda.value,o=this.medicos.find(l=>l.id===e.uidMedico),a=o?o.nombre:"Sin asignar";if(!(e.isRecurring&&e.recurringDays.length>0))if(this.selectedDates.length>0)for(let l of this.selectedDates){if(new Date(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate())<=t){this.mensajeError="Solo se pueden crear agendas para fechas futuras.";return}let ee={uidMedico:e.uidMedico,fecha:l.toISOString().split("T")[0],horaInicio:e.horaInicio,horaFin:e.horaFin,disponible:e.disponible,medicoNombre:a};yield this.agendaService.addAgenda(ee)}else{let l=new Date(e.fecha);if(new Date(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate())<=t){this.mensajeError="Solo se pueden crear agendas para fechas futuras.";return}let ee=U(P({},e),{medicoNombre:a});this.agenda?.id&&(ee.id=this.agenda.id),this.onSave.emit(ee)}this.cargarAgendasMedico(e.uidMedico),setTimeout(()=>{this.destroyAndReinitCalendar()},0),this.selectedDates=[],this.formAgenda.reset()}})}editarAgenda(t){this.editingAgenda=t,this.formAgenda.patchValue(t)}eliminarAgenda(t){t.id&&this.agendaService.deleteAgenda(Number(t.id)).subscribe({next:()=>{this.formAgenda.value.uidMedico!==void 0&&this.cargarAgendasMedico(this.formAgenda.value.uidMedico),setTimeout(()=>{this.destroyAndReinitCalendar()},0)},error:()=>{this.mensajeError="Error al eliminar la agenda."}})}cancelar(){this.editingAgenda=null,this.selectedDates=[],window.location.reload()}destroyAndReinitCalendar(){this.calendar&&this.calendar.destroy(),this.initCalendar()}updateCalendarEvents(){this.calendar&&(this.calendar.removeAllEvents(),this.agendasMedico.forEach(t=>{this.calendar.addEvent({id:t.id?.toString(),title:`${t.medico?.nombre||t.medicoNombre||""} (${t.horaInicio} - ${t.horaFin})`,start:t.fecha+"T"+t.horaInicio,end:t.fecha+"T"+t.horaFin})}))}initCalendar(){this.calendar=new window.FullCalendar.Calendar(document.getElementById("calendar"),{initialView:"dayGridMonth",selectable:!0,editable:!1,events:[],dateClick:t=>{this.formAgenda.patchValue({fecha:t.dateStr})},eventClick:t=>{}}),this.calendar.render(),this.updateCalendarEvents()}handleDateSelect(t){let e=t.startStr.split("T")[0];this.formAgenda.patchValue({fecha:e})}handleEventClick(t){let e=t.event.extendedProps;this.editarAgenda(e)}handleEventDrop(t){}handleEventResize(t){}setMenuOpcion(t){this.menuOpcion=t}padTime(t){return t<10?"0"+t:t.toString()}static \u0275fac=function(e){return new(e||c)(b(J),b(ie),b(Re))};static \u0275cmp=v({type:c,selectors:[["app-agenda-form"]],viewQuery:function(e,o){if(e&1&&qe(Pt,5),e&2){let a;Ue(a=Ge())&&(o.calendarDiv=a.first)}},inputs:{agenda:"agenda",medicos:"medicos",errorPadre:"errorPadre",menuOpcion:"menuOpcion"},outputs:{onSave:"onSave",onCancel:"onCancel",onError:"onError"},features:[$],decls:5,vars:3,consts:[[4,"ngIf"],["id","calendar",2,"max-width","900px","margin","40px auto"],[3,"ngSubmit","formGroup"],[1,"form-group"],["formControlName","uidMedico",1,"form-control",3,"change"],[3,"value",4,"ngFor","ngForOf"],["type","date","formControlName","fecha",1,"form-control",3,"min"],["type","time","formControlName","horaInicio",1,"form-control"],["type","time","formControlName","horaFin",1,"form-control"],[1,"form-group","form-check"],["type","checkbox","formControlName","disponible",1,"form-check-input"],[1,"form-check-label"],["class","alert alert-danger",4,"ngIf"],["type","submit",1,"btn","btn-primary",3,"disabled"],["type","button",1,"btn","btn-secondary",3,"click"],[3,"value"],[1,"alert","alert-danger"],[1,"form-group","mt-3"],[1,"mb-2"],[1,"dias-semana-container"],["class","dia-checkbox",4,"ngFor","ngForOf"],[1,"form-group","mt-2"],["type","date","name","fechaInicioMes",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions","min"],["type","date","name","fechaFinMes",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],["type","time","name","horaInicioBloque",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],["type","time","name","horaFinBloque",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],[1,"form-group","form-check","mt-2"],["type","submit",1,"btn","btn-success","mt-2"],["type","button",1,"btn","btn-secondary","mt-2",3,"click"],[1,"dia-checkbox"],["type","checkbox",3,"ngModelChange","ngModel","ngModelOptions","name"],["type","date","formControlName","fecha",1,"form-control"]],template:function(e,o){e&1&&(_(0,Et,29,6,"div",0)(1,Nt,38,18,"div",0)(2,Lt,29,5,"div",0),C(3,"hr")(4,"div",1)),e&2&&(s("ngIf",o.menuOpcion==="unitaria"),d(),s("ngIf",o.menuOpcion==="completa"),d(),s("ngIf",o.menuOpcion==="actualizacion"))},dependencies:[O,w,S,X,z,ue,fe,D,et,ge,k,L,Q,Z,K,te],styles:["[_nghost-%COMP%]{display:block;padding:1rem;max-width:600px;margin:auto;box-sizing:border-box}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem;background-color:#fff;padding:2rem;border-radius:12px;box-shadow:0 4px 12px #0000001a}label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.25rem;color:#333}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #ccc;border-radius:8px;font-size:1rem;width:100%;box-sizing:border-box;transition:border-color .2s ease-in-out}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}button[_ngcontent-%COMP%]{padding:.75rem;border:none;border-radius:8px;background-color:#007bff;color:#fff;font-size:1rem;font-weight:700;cursor:pointer;transition:background-color .2s ease-in-out}button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.error-message[_ngcontent-%COMP%]{color:red;font-size:.9rem}.success-message[_ngcontent-%COMP%]{color:green;font-size:.9rem}.dias-semana-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:16px;justify-content:flex-start;align-items:center;flex-wrap:wrap;margin-bottom:10px}.dia-checkbox[_ngcontent-%COMP%]{display:flex;align-items:center;background:#f5f5f5;border-radius:6px;padding:6px 12px;margin-right:0;font-weight:500;box-shadow:0 1px 2px #0000000a;transition:background .2s}.dia-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-right:6px}.dia-checkbox[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:15px}.dia-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + span[_ngcontent-%COMP%]{color:#0d6efd;font-weight:700}@media (max-width: 600px){form[_ngcontent-%COMP%]{padding:1rem;border-radius:8px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], button[_ngcontent-%COMP%]{font-size:.95rem;padding:.65rem}button[_ngcontent-%COMP%]{width:100%}}"]})};var zt=()=>({standalone:!0});function jt(c,t){if(c&1){let e=M();i(0,"div")(1,"app-agenda-form",6),p("onSave",function(a){g(e);let l=m();return u(l.onSaveAgenda(a))})("onCancel",function(){g(e);let a=m();return u(a.cancelarEdicion())}),n()()}if(c&2){let e=m();d(),s("medicos",e.medicos)("menuOpcion",e.menuOpcion)}}function Bt(c,t){if(c&1){let e=M();i(0,"div")(1,"app-agenda-form",6),p("onSave",function(a){g(e);let l=m();return u(l.onSaveAgenda(a))})("onCancel",function(){g(e);let a=m();return u(a.cancelarEdicion())}),n()()}if(c&2){let e=m();d(),s("medicos",e.medicos)("menuOpcion",e.menuOpcion)}}function Rt(c,t){if(c&1&&(i(0,"option",14),r(1),n()),c&2){let e=t.$implicit;s("value",e.id),d(),f(e.nombre)}}function qt(c,t){if(c&1){let e=M();i(0,"tr")(1,"td",15),r(2),n(),i(3,"td",16),r(4),n(),i(5,"td",17),r(6),n(),i(7,"td",18),r(8),n(),i(9,"td",19)(10,"button",20),p("click",function(){let a=g(e).$implicit,l=m(2);return u(l.editAgenda(a))}),r(11,"Editar"),n(),i(12,"button",21),p("click",function(){let a=g(e).$implicit,l=m(2);return u(l.deleteAgenda(a.id))}),r(13,"Eliminar"),n()()()}if(c&2){let e=t.$implicit;d(2),f(e.fecha),d(2),f(e.horaInicio),d(2),f(e.horaFin),d(2),f(e.disponible?"S\xED":"No")}}function Ut(c,t){if(c&1){let e=M();i(0,"div")(1,"app-agenda-form",22),p("onSave",function(a){g(e);let l=m(2);return u(l.onSaveAgenda(a))})("onCancel",function(){g(e);let a=m(2);return u(a.cancelarEdicion())}),n()()}if(c&2){let e=m(2);d(),s("agenda",e.selectedAgenda)("medicos",e.medicos)("errorPadre",e.errorPadre)}}function Gt(c,t){if(c&1){let e=M();i(0,"div")(1,"div",7)(2,"div",8)(3,"select",9),N("ngModelChange",function(a){g(e);let l=m();return I(l.medicoFiltradoId,a)||(l.medicoFiltradoId=a),u(a)}),p("change",function(){g(e);let a=m();return u(a.filtrarAgendasPorMedico())}),i(4,"option",10),r(5,"-- Selecciona un m\xE9dico --"),n(),_(6,Rt,2,2,"option",11),n()()(),i(7,"table",12)(8,"thead")(9,"tr")(10,"th"),r(11,"Fecha"),n(),i(12,"th"),r(13,"Hora Inicio"),n(),i(14,"th"),r(15,"Hora Fin"),n(),i(16,"th"),r(17,"Disponible"),n(),i(18,"th"),r(19,"Acciones"),n()()(),i(20,"tbody"),_(21,qt,14,4,"tr",13),V(22,"async"),n()(),_(23,Ut,2,3,"div",5),n()}if(c&2){let e=m();d(3),F("ngModel",e.medicoFiltradoId),s("ngModelOptions",W(7,zt)),d(3),s("ngForOf",e.medicos),d(15),s("ngForOf",H(22,5,e.agendas$)),d(2),s("ngIf",e.selectedAgenda)}}var Pe=class c{constructor(t,e){this.agendaService=t;this.medicoService=e}agendas$;medicos=[];selectedAgenda;errorPadre="";filtroMedico="";medicoFiltradoId="";menuOpcion="unitaria";ngOnInit(){this.loadMedicos(),this.loadAgendas()}loadMedicos(){this.medicoService.getMedicos().subscribe(t=>{this.medicos=t})}loadAgendas(){this.agendas$=this.agendaService.getAgendas()}editAgenda(t){this.selectedAgenda=P({},t)}deleteAgenda(t){confirm("\xBFSeguro que quieres eliminar esta agenda?")&&this.agendaService.deleteAgenda(Number(t)).subscribe({next:()=>this.loadAgendas(),error:()=>alert("Error al eliminar la agenda.")})}onSaveAgenda(t){this.errorPadre="",t.id?this.agendaService.updateAgenda(Number(t.id),t).subscribe({next:()=>{this.selectedAgenda=void 0,this.loadAgendas()},error:()=>alert("Error al actualizar la agenda.")}):this.agendaService.getAgendasByMedico(Number(t.uidMedico)).subscribe(e=>{if((e||[]).find(l=>l.fecha===t.fecha)){this.errorPadre="Ya existe una agenda para este m\xE9dico en la fecha seleccionada.";return}if((e||[]).some(l=>l.fecha===t.fecha&&(t.horaInicio>=l.horaInicio&&t.horaInicio<l.horaFin||t.horaFin>l.horaInicio&&t.horaFin<=l.horaFin||t.horaInicio<=l.horaInicio&&t.horaFin>=l.horaFin))){this.errorPadre="El m\xE9dico ya tiene una agenda en ese horario.";return}this.agendaService.addAgenda(t).subscribe({next:()=>{this.selectedAgenda=void 0,this.loadAgendas()},error:()=>alert("Error al agregar la agenda.")})})}cancelarEdicion(){this.selectedAgenda=void 0}getNombreMedico(t){if(!t)return"Sin asignar";let e=typeof t=="string"?Number(t):t;if(isNaN(e))return"Sin asignar";let o=this.medicos.find(a=>String(a.id)===String(e));return o?o.nombre:"Sin asignar"}get medicosFiltrados(){return this.filtroMedico.trim()?this.medicos.filter(t=>t.nombre.toLowerCase().includes(this.filtroMedico.toLowerCase())):this.medicos}filtrarAgendasPorMedico(){this.medicoFiltradoId?this.agendas$=this.agendaService.getAgendasByMedico(Number(this.medicoFiltradoId)):this.loadAgendas(),this.selectedAgenda=void 0}setMenuOpcion(t){this.menuOpcion=t,this.selectedAgenda=void 0,this.errorPadre=""}static \u0275fac=function(e){return new(e||c)(b(ie),b(j))};static \u0275cmp=v({type:c,selectors:[["app-agenda-list"]],decls:13,vars:9,consts:[[1,"container"],[1,"agenda-menu",2,"margin-bottom","24px","text-align","center"],[1,"btn","btn-outline-primary",3,"click"],[1,"btn","btn-outline-success",3,"click"],[1,"btn","btn-outline-info",3,"click"],[4,"ngIf"],[3,"onSave","onCancel","medicos","menuOpcion"],[1,"row","mb-3"],[1,"col-md-12"],[1,"form-control",3,"ngModelChange","change","ngModel","ngModelOptions"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"table","table-striped","mt-3"],[4,"ngFor","ngForOf"],[3,"value"],["data-label","Fecha"],["data-label","Hora Inicio"],["data-label","Hora Fin"],["data-label","Disponible"],["data-label","Acciones"],[1,"btn","btn-sm","btn-warning","btn-edit",3,"click"],[1,"btn","btn-sm","btn-danger","btn-delete",3,"click"],[3,"onSave","onCancel","agenda","medicos","errorPadre"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"h2"),r(2,"Gesti\xF3n de Agendas M\xE9dicas"),n(),i(3,"div",1)(4,"button",2),p("click",function(){return o.setMenuOpcion("unitaria")}),r(5,"Crear agenda unitaria"),n(),i(6,"button",3),p("click",function(){return o.setMenuOpcion("completa")}),r(7,"Crear agenda completa"),n(),i(8,"button",4),p("click",function(){return o.setMenuOpcion("actualizacion")}),r(9,"Actualizaci\xF3n"),n()(),_(10,jt,2,2,"div",5)(11,Bt,2,2,"div",5)(12,Gt,24,8,"div",5),n()),e&2&&(d(4),me("active",o.menuOpcion==="unitaria"),d(2),me("active",o.menuOpcion==="completa"),d(2),me("active",o.menuOpcion==="actualizacion"),d(2),s("ngIf",o.menuOpcion==="unitaria"),d(),s("ngIf",o.menuOpcion==="completa"),d(),s("ngIf",o.menuOpcion==="actualizacion"))},dependencies:[O,w,S,Y,K,ue,fe,ge,k,te,Oe],styles:["[_nghost-%COMP%]{display:block;padding:1rem;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;max-width:1000px;margin:0 auto;box-sizing:border-box}h2[_ngcontent-%COMP%]{margin-bottom:1rem;color:#2c3e50;text-align:center}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:2rem;box-shadow:0 2px 6px #0000001a;background-color:#fff;border-radius:10px;overflow:hidden}thead[_ngcontent-%COMP%]{background-color:#3498db;color:#fff}thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{text-align:left;padding:.75rem;font-weight:700}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #ddd;transition:background-color .3s ease}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;color:#333;word-wrap:break-word;vertical-align:middle}.btn[_ngcontent-%COMP%]{padding:.4rem .8rem;margin-right:.3rem;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s ease;font-size:.85rem;white-space:nowrap}.btn-edit[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff}.btn-edit[_ngcontent-%COMP%]:hover{background-color:#e67e22}.btn-delete[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff}.btn-delete[_ngcontent-%COMP%]:hover{background-color:#c0392b}select.form-control[_ngcontent-%COMP%]{border:1px solid #ced4da;border-radius:6px;font-size:1.1rem;padding:8px 12px;background:#f8fafd;color:#222;transition:border-color .2s}select.form-control[_ngcontent-%COMP%]:focus{border-color:#86b7fe;outline:none;box-shadow:0 0 0 2px #0d6efd22}option[_ngcontent-%COMP%]{background:#fff;color:#222}@media (max-width: 768px){[_nghost-%COMP%]{padding:.5rem}table[_ngcontent-%COMP%]{border:0}thead[_ngcontent-%COMP%]{display:none}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:1rem;background-color:#fff;border-radius:10px;box-shadow:0 1px 3px #0000001a;padding:1rem}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0;text-align:left;border-bottom:1px solid #eee;position:relative;word-wrap:break-word}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-bottom:0;padding-top:.75rem}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label);flex-basis:40%;font-weight:700;color:#666;padding-right:1rem;white-space:nowrap}tbody[_ngcontent-%COMP%]   td[data-label=Acciones][_ngcontent-%COMP%]{display:flex;gap:.5rem;justify-content:flex-start}tbody[_ngcontent-%COMP%]   td[data-label=Acciones][_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:1;padding:.5rem;font-size:.9rem;margin-right:0}}"]})};function $t(c,t){if(c&1){let e=M();i(0,"div",9)(1,"div",10)(2,"form",11),p("ngSubmit",function(){g(e);let a=m();return u(a.aplicarFiltros())}),i(3,"div",12)(4,"label",13),r(5,"Paciente"),n(),i(6,"input",14),N("ngModelChange",function(a){g(e);let l=m();return I(l.filtros.pacienteNombre,a)||(l.filtros.pacienteNombre=a),u(a)}),n()(),i(7,"div",12)(8,"label",15),r(9,"M\xE9dico"),n(),i(10,"input",16),N("ngModelChange",function(a){g(e);let l=m();return I(l.filtros.medicoNombre,a)||(l.filtros.medicoNombre=a),u(a)}),n()(),i(11,"div",17)(12,"button",18),p("click",function(){g(e);let a=m();return u(a.limpiarFiltros())}),r(13,"Limpiar"),n(),i(14,"button",19),r(15,"Aplicar"),n()()()()()}if(c&2){let e=m();d(6),F("ngModel",e.filtros.pacienteNombre),d(4),F("ngModel",e.filtros.medicoNombre)}}function Wt(c,t){if(c&1&&(i(0,"tr")(1,"td"),r(2),n(),i(3,"td"),r(4),n(),i(5,"td"),r(6),n(),i(7,"td"),r(8),V(9,"date"),n(),i(10,"td"),r(11),n(),i(12,"td"),r(13),n()()),c&2){let e=t.$implicit;d(2),f(e.id),d(2),f(e.pacienteNombre),d(2),f(e.medicoNombre),d(2),f(He(9,6,e.fecha,"dd/MM/yyyy")),d(3),f(e.motivo),d(2),f(e.estado)}}var Se=class c{constructor(t,e,o){this.citasService=t;this.usuarioService=e;this.medicoService=o}citas=[];citasDetalladas=[];filtrosVisibles=!1;filtros={pacienteNombre:"",medicoNombre:"",estado:"",especialidad:""};isLoading=!0;ngOnInit(){this.loadAllData()}loadAllData(){this.isLoading=!0,this.citasService.getCitas().subscribe({next:t=>{this.citasDetalladas=t,this.citas=[...this.citasDetalladas],this.isLoading=!1},error:t=>{console.error("Error al cargar las citas",t),this.isLoading=!1}})}aplicarFiltros(){let t=[...this.citasDetalladas],e=this.filtros.pacienteNombre?.toLowerCase().trim();e&&(t=t.filter(h=>h.pacienteNombre?.toLowerCase().includes(e)));let o=this.filtros.medicoNombre?.toLowerCase().trim();o&&(t=t.filter(h=>h.medicoNombre?.toLowerCase().includes(o)));let a=this.filtros.estado?.toLowerCase().trim();a&&(t=t.filter(h=>h.estado.toLowerCase()===a));let l=this.filtros.especialidad?.toLowerCase().trim();l&&(t=t.filter(h=>h.medico?.especialidad.toLowerCase().includes(l))),this.citas=t}limpiarFiltros(){this.filtros={pacienteNombre:"",medicoNombre:"",estado:"",especialidad:""},this.citas=[...this.citasDetalladas]}toggleFiltros(){this.filtrosVisibles=!this.filtrosVisibles}descargarPdf(){this.citasService.getReportePdf(this.filtros).subscribe(t=>{let e=window.URL.createObjectURL(t),o=document.createElement("a");o.href=e,o.download="reporte_citas.pdf",o.click(),window.URL.revokeObjectURL(e)})}descargarExcel(){this.citasService.getReporteExcel(this.filtros).subscribe(t=>{let e=window.URL.createObjectURL(t),o=document.createElement("a");o.href=e,o.download="reporte_citas.xlsx",o.click(),window.URL.revokeObjectURL(e)})}static \u0275fac=function(e){return new(e||c)(b(ne),b(A),b(j))};static \u0275cmp=v({type:c,selectors:[["app-citas"]],decls:30,vars:3,consts:[[1,"container","mt-4"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"btn","btn-secondary","me-2",3,"click"],[1,"btn","btn-danger","me-2",3,"click"],[1,"btn","btn-success",3,"click"],["class","card mb-4",4,"ngIf"],[1,"table-responsive"],[1,"table","table-striped"],[4,"ngFor","ngForOf"],[1,"card","mb-4"],[1,"card-body"],[1,"row","g-3",3,"ngSubmit"],[1,"col-md-6"],["for","pacienteNombre",1,"form-label"],["type","text","id","pacienteNombre","name","pacienteNombre",1,"form-control",3,"ngModelChange","ngModel"],["for","medicoNombre",1,"form-label"],["type","text","id","medicoNombre","name","medicoNombre",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-12","text-end"],["type","button",1,"btn","btn-light","me-2",3,"click"],["type","submit",1,"btn","btn-primary"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"h2"),r(3,"Historial de Citas"),n(),i(4,"div")(5,"button",2),p("click",function(){return o.toggleFiltros()}),r(6),n(),i(7,"button",3),p("click",function(){return o.descargarPdf()}),r(8,"PDF"),n(),i(9,"button",4),p("click",function(){return o.descargarExcel()}),r(10,"Excel"),n()()(),_(11,$t,16,2,"div",5),i(12,"div",6)(13,"table",7)(14,"thead")(15,"tr")(16,"th"),r(17,"ID"),n(),i(18,"th"),r(19,"Paciente"),n(),i(20,"th"),r(21,"M\xE9dico"),n(),i(22,"th"),r(23,"Fecha"),n(),i(24,"th"),r(25,"Motivo"),n(),i(26,"th"),r(27,"Estado"),n()()(),i(28,"tbody"),_(29,Wt,14,9,"tr",8),n()()()()),e&2&&(d(6),y(" ",o.filtrosVisibles?"Ocultar":"Mostrar"," Filtros "),d(5),s("ngIf",o.filtrosVisibles),d(18),s("ngForOf",o.citas))},dependencies:[O,w,S,Qe,K,z,D,k,L,te,tt],styles:["[_nghost-%COMP%]{display:block;padding:2rem;background-color:#f5f7fa;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;color:#333}h2[_ngcontent-%COMP%]{color:#2c3e50;font-weight:600;margin-bottom:1rem}.btn[_ngcontent-%COMP%]{border-radius:8px;padding:8px 16px;font-weight:500;transition:background-color .3s,border-color .3s;font-size:.95rem;border:none;color:#fff}.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#5a6268}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#0069d9}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c82333}.btn-success[_ngcontent-%COMP%]{background-color:#28a745}.btn-success[_ngcontent-%COMP%]:hover{background-color:#218838}.btn-light[_ngcontent-%COMP%]{background-color:#e2e6ea;color:#212529}.btn-light[_ngcontent-%COMP%]:hover{background-color:#d6d8db}.card[_ngcontent-%COMP%]{border:none;border-radius:12px;box-shadow:0 2px 8px #0000000d;background-color:#fff}.card-body[_ngcontent-%COMP%]{padding:1.5rem}.form-label[_ngcontent-%COMP%]{font-weight:500;color:#444}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{border-radius:6px;border:1px solid #ced4da}.table-responsive[_ngcontent-%COMP%]{border-radius:8px;overflow:hidden}.table[_ngcontent-%COMP%]{margin-top:1.5rem;border-collapse:collapse;width:100%}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#e9ecef}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.75rem;text-align:left;font-weight:600;color:#495057}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{background-color:#fff;border-bottom:1px solid #dee2e6;transition:background-color .2s ease}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f1f3f5}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem;vertical-align:middle;color:#333}@media (max-width: 768px){.d-flex[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start!important}.d-flex[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1rem}.d-flex[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{width:100%;display:flex;flex-wrap:wrap;gap:.5rem}.btn[_ngcontent-%COMP%]{width:100%}.text-end[_ngcontent-%COMP%]{text-align:start!important;margin-top:1rem}}"]})};function Ht(c,t){c&1&&(i(0,"div",2)(1,"label"),r(2,"Contrase\xF1a"),n(),C(3,"input",12),n())}var ye=class c{constructor(t,e,o,a,l){this.fb=t;this.usuarioService=e;this.router=o;this.route=a;this.snackBar=l}admin=null;formSubmit=new E;cancelEdit=new E;adminForm;isEdit=!1;uid=null;ngOnInit(){this.initForm(),this.route.snapshot.paramMap.get("id")&&this.admin}ngOnChanges(t){t.admin&&this.admin&&(this.isEdit=!0,this.uid=this.admin.id??this.admin.uid??null,this.adminForm.patchValue({nombre:this.admin.nombre,direccion:this.admin.direccion,fechaNacimiento:this.admin.fechaNacimiento,email:this.admin.email,contacto:this.admin.contacto}),this.adminForm.get("password")?.clearValidators(),this.adminForm.get("password")?.updateValueAndValidity())}initForm(){this.adminForm=this.fb.group({nombre:["",x.required],direccion:["",x.required],fechaNacimiento:["",x.required],email:["",[x.required,x.email]],password:[""],contacto:["",x.required]})}guardar(){return se(this,null,function*(){if(this.adminForm.invalid)return;let l=this.adminForm.value,{password:t}=l,e=De(l,["password"]),o=e.fechaNacimiento;if(o instanceof Date)o=o.toISOString().split("T")[0];else if(typeof o=="string"&&o.includes("/")){let[h,ee,ke]=o.split("/");o=`${ke}-${ee.padStart(2,"0")}-${h.padStart(2,"0")}`}let a=P(U(P({},e),{fecha_nacimiento:o,rol:"administrador",uid:this.admin?.uid}),t?{password:t}:{});if(delete a.fechaNacimiento,this.isEdit&&this.uid){let h=typeof this.uid=="string"?parseInt(this.uid,10):this.uid;if(isNaN(h)){this.snackBar.open("ID de administrador inv\xE1lido","Cerrar",{duration:3e3,verticalPosition:"top"});return}this.usuarioService.updateUsuario(h,a).subscribe({next:()=>{this.snackBar.open("Administrador actualizado","Cerrar",{duration:3e3,verticalPosition:"top"}),this.resetForm(),this.formSubmit.emit(),this.router.navigate(["/admin/Admin"])},error:()=>{this.snackBar.open("Error al actualizar el administrador","Cerrar",{duration:3e3,verticalPosition:"top"})}})}else this.usuarioService.createUsuario(a).subscribe({next:()=>{this.snackBar.open("Administrador registrado","Cerrar",{duration:3e3,verticalPosition:"top"}),this.router.navigate(["/admin/Admin"]),this.resetForm(),this.formSubmit.emit()},error:()=>{this.snackBar.open("Error al registrar el administrador","Cerrar",{duration:3e3,verticalPosition:"top"})}})})}resetForm(){this.isEdit=!1,this.uid=null,this.admin=null,this.adminForm.reset(),this.adminForm.get("password")?.setValidators(x.required),this.adminForm.get("password")?.updateValueAndValidity()}cancelar(){this.resetForm(),this.cancelEdit.emit()}static \u0275fac=function(e){return new(e||c)(b(J),b(A),b(pe),b(Ze),b(ot))};static \u0275cmp=v({type:c,selectors:[["app-admin-form"]],inputs:{admin:"admin"},outputs:{formSubmit:"formSubmit",cancelEdit:"cancelEdit"},features:[$],decls:30,vars:5,consts:[[1,"container"],[3,"ngSubmit","formGroup"],[1,"form-group"],["type","text","formControlName","nombre",1,"form-control"],["type","text","formControlName","direccion",1,"form-control"],["type","date","formControlName","fechaNacimiento",1,"form-control"],["type","email","formControlName","email",1,"form-control",3,"readonly"],["class","form-group",4,"ngIf"],["type","text","formControlName","contacto",1,"form-control"],[1,"buttons"],["type","submit"],["type","button",1,"cancel-btn",3,"click"],["type","password","formControlName","password",1,"form-control"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"h2"),r(2),n(),i(3,"form",1),p("ngSubmit",function(){return o.guardar()}),i(4,"div",2)(5,"label"),r(6,"Nombre"),n(),C(7,"input",3),n(),i(8,"div",2)(9,"label"),r(10,"Direcci\xF3n"),n(),C(11,"input",4),n(),i(12,"div",2)(13,"label"),r(14,"Fecha de Nacimiento"),n(),C(15,"input",5),n(),i(16,"div",2)(17,"label"),r(18,"Email"),n(),C(19,"input",6),n(),_(20,Ht,4,0,"div",7),i(21,"div",2)(22,"label"),r(23,"Contacto"),n(),C(24,"input",8),n(),i(25,"div",9)(26,"button",10),r(27),n(),i(28,"button",11),p("click",function(){return o.cancelar()}),r(29,"Cancelar"),n()()()()),e&2&&(d(2),f(o.isEdit?"Editar Administrador":"Registrar Administrador"),d(),s("formGroup",o.adminForm),d(16),s("readonly",o.isEdit),d(),s("ngIf",!o.isEdit),d(7),f(o.isEdit?"Actualizar":"Registrar"))},dependencies:[O,S,X,z,D,k,L,Q,Z,rt],styles:[".container[_ngcontent-%COMP%]{margin:2rem auto;padding:1rem 2rem;background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;color:#333;box-sizing:border-box}h2[_ngcontent-%COMP%]{margin-bottom:1.5rem;font-weight:600;color:#2c3e50;text-align:center}form[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:1rem 2rem;justify-content:space-between;background:#ecf0f1;padding:1rem 1.5rem;border-radius:8px;box-shadow:inset 0 0 5px #0000000d;margin-bottom:2rem;box-sizing:border-box}form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1 1 45%;display:flex;flex-direction:column;min-width:250px}form[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;margin-bottom:.3rem;color:#34495e}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:.5rem .8rem;font-size:1rem;border:1px solid #bdc3c7;border-radius:4px;transition:border-color .2s ease-in-out}form[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, form[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#2980b9;box-shadow:0 0 4px #2980b9aa}form[_ngcontent-%COMP%]   .error-message[_ngcontent-%COMP%]{color:#e74c3c;font-size:.85rem;margin-top:.2rem}form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{flex-basis:100%;display:flex;justify-content:flex-end;gap:1rem;margin-top:.5rem}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#27ae60;border:none;padding:.6rem 1.2rem;color:#fff;font-size:1rem;border-radius:4px;cursor:pointer;transition:background-color .2s ease-in-out}form[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]{background-color:#c0392b}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#219150}form[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]:hover{background-color:#962d22}.google[_ngcontent-%COMP%]{padding:10px;background-color:#e74c3c;color:#fff;border-radius:5px;border:none;outline:none;cursor:pointer}.google[_ngcontent-%COMP%]:hover{background-color:#ac291b}.admin-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1.5rem;font-size:.95rem}.admin-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#2980b9;color:#fff}.admin-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #ddd;text-align:left}.admin-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.admin-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;border:none;padding:.4rem .8rem;color:#fff;font-size:.85rem;border-radius:4px;cursor:pointer;margin-right:.5rem;transition:background-color .2s ease-in-out}.admin-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#1d6fa5}@media (max-width: 768px){form[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}form[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1 1 100%;min-width:unset}form[_ngcontent-%COMP%]   .buttons[_ngcontent-%COMP%]{justify-content:center}.admin-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.admin-table[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:block;width:100%}.admin-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{margin-bottom:1rem;border:1px solid #ddd;border-radius:8px;padding:1rem}.admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-left:50%;position:relative;text-align:left;border:none;border-bottom:1px solid #eee}.admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-bottom:0}.admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label);position:absolute;left:1rem;top:.75rem;font-weight:600;color:#2980b9}}"]})};function Yt(c,t){if(c&1){let e=M();i(0,"tr")(1,"td",4),r(2),n(),i(3,"td",5),r(4),n(),i(5,"td",6),r(6),n(),i(7,"td",7),r(8),n(),i(9,"td",8)(10,"button",9),p("click",function(){let a=g(e).$implicit,l=m();return u(l.editAdmin(a))}),r(11,"Editar"),n(),i(12,"button",9),p("click",function(){let a=g(e).$implicit,l=m();return u(l.deleteAdmin(a))}),r(13,"Eliminar"),n()()()}if(c&2){let e=t.$implicit;d(2),f(e.nombre),d(2),f(e.email),d(2),f(e.contacto),d(2),f(e.fechaNacimiento)}}var we=class c{constructor(t){this.usuarioService=t}admins$;selectedAdmin=null;ngOnInit(){this.admins$=this.usuarioService.getAdmins()}editAdmin(t){this.selectedAdmin=P({},t)}deleteAdmin(t){let e=t.id??t.uid;if(!e){alert("No se puede eliminar: el usuario no tiene id ni uid.");return}confirm("\xBFSeguro que quieres eliminar?")&&this.usuarioService.deleteUsuario(e).subscribe({next:()=>this.admins$=this.usuarioService.getAdmins(),error:()=>alert("Error al eliminar el administrador.")})}onFormSubmit(){this.selectedAdmin=null,this.admins$=this.usuarioService.getAdmins()}static \u0275fac=function(e){return new(e||c)(b(A))};static \u0275cmp=v({type:c,selectors:[["app-admin-list"]],decls:18,vars:4,consts:[[1,"container"],[3,"formSubmit","cancelEdit","admin"],[1,"admin-table"],[4,"ngFor","ngForOf"],["data-label","Nombre"],["data-label","Email"],["data-label","Contacto"],["data-label","Fecha Nacimiento"],["data-label","Acciones"],[3,"click"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"app-admin-form",1),p("formSubmit",function(){return o.onFormSubmit()})("cancelEdit",function(){return o.selectedAdmin=null}),n(),i(2,"table",2)(3,"thead")(4,"tr")(5,"th"),r(6,"Nombre"),n(),i(7,"th"),r(8,"Email"),n(),i(9,"th"),r(10,"Contacto"),n(),i(11,"th"),r(12,"Fecha Nacimiento"),n(),i(13,"th"),r(14,"Acciones"),n()()(),i(15,"tbody"),_(16,Yt,14,4,"tr",3),V(17,"async"),n()()()),e&2&&(d(),s("admin",o.selectedAdmin),d(15),s("ngForOf",H(17,2,o.admins$)))},dependencies:[O,w,Y,ye],styles:[".container[_ngcontent-%COMP%]{margin:2rem auto;padding:1rem 2rem;background:#fff;border-radius:8px;box-shadow:0 2px 8px #0000001a;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;color:#333}.admin-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:1.5rem}.admin-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#2980b9;color:#fff}.admin-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;border:1px solid #ddd;text-align:left;font-size:.95rem}.admin-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.admin-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;border:none;padding:.4rem .8rem;color:#fff;font-size:.85rem;border-radius:4px;cursor:pointer;margin-right:.5rem;transition:background-color .2s ease-in-out}.admin-table[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#1d6fa5}@media (max-width: 768px){.admin-table[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .admin-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;width:100%}.admin-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.admin-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{margin-bottom:1rem;border:1px solid #ccc;border-radius:8px;padding:.5rem;box-shadow:0 1px 4px #0000000d}.admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:9px 0;border:none;border-bottom:1px solid #eee;font-size:.95rem}.admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label);font-weight:600;color:#2c3e50;flex-basis:40%;text-align:left}.admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding-right:15px;text-align:right}.admin-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-bottom:none}}"]})};function Qt(c,t){c&1&&(i(0,"div",3),r(1,"Cargando citas..."),n())}function Zt(c,t){c&1&&(i(0,"div"),r(1," No hay citas pendientes por revisar. "),n())}function Jt(c,t){if(c&1){let e=M();i(0,"tr")(1,"td"),r(2),n(),i(3,"td"),r(4),n(),i(5,"td"),r(6),n(),i(7,"td"),r(8),n(),i(9,"td"),r(10),n(),i(11,"td")(12,"button",6),p("click",function(){let a=g(e).$implicit,l=m(2);return u(l.confirmarCita(a))}),r(13,"Confirmar"),n(),i(14,"button",7),p("click",function(){let a=g(e).$implicit,l=m(2);return u(l.rechazarCita(a))}),r(15,"Rechazar"),n()()()}if(c&2){let e=t.$implicit;d(2),y("",e.paciente==null?null:e.paciente.nombre," "),d(2),y("",e.medico==null?null:e.medico.nombre," "),d(2),f(e.fecha),d(2),f(e.horaInicio),d(2),f(e.motivo)}}function Kt(c,t){if(c&1&&(i(0,"div")(1,"table",4)(2,"thead")(3,"tr")(4,"th"),r(5,"Paciente"),n(),i(6,"th"),r(7,"M\xE9dico"),n(),i(8,"th"),r(9,"Fecha"),n(),i(10,"th"),r(11,"Hora"),n(),i(12,"th"),r(13,"Motivo"),n(),i(14,"th"),r(15,"Acciones"),n()()(),i(16,"tbody"),_(17,Jt,16,5,"tr",5),n()()()),c&2){let e=m();d(17),s("ngForOf",e.citasPendientes)}}var Ee=class c{constructor(t,e,o,a,l){this.citasService=t;this.notificacionesService=e;this.agendaService=o;this.medicoService=a;this.usuarioService=l}citasPendientes=[];loading=!0;ngOnInit(){this.obtenerCitasPendientes()}obtenerCitasPendientes(){ze({citas:this.citasService.getCitas(),pacientes:this.usuarioService.getPacientes(),medicos:this.medicoService.getMedicos()}).pipe(Le(({citas:t,pacientes:e,medicos:o})=>t.filter(a=>a.estado==="pendiente").map(a=>U(P({},a),{paciente:e.find(l=>l.id===a.pacienteId),medico:o.find(l=>l.id===a.medicoId)})))).subscribe(t=>{this.citasPendientes=t,this.loading=!1})}confirmarCita(t){if(!t.id||!t.agendaId){this.notificacionesService.mostrarNotificacion("Error","Datos de la cita incompletos.","error");return}this.citasService.updateEstadoCita(t.id,"confirmada").pipe(Te(()=>this.agendaService.updateDisponibilidadAgenda(t.agendaId,!1))).subscribe({next:()=>{this.notificacionesService.mostrarNotificacion("Cita Confirmada","La cita ha sido confirmada y la agenda ha sido actualizada.","success"),this.obtenerCitasPendientes()},error:e=>{console.error("Error al confirmar la cita:",e),this.notificacionesService.mostrarNotificacion("Error","Ocurri\xF3 un error al confirmar la cita.","error")}})}rechazarCita(t){if(!t.id||!t.agendaId){this.notificacionesService.mostrarNotificacion("Error","Datos de la cita incompletos.","error");return}this.citasService.updateEstadoCita(t.id,"rechazada").pipe(Te(()=>this.agendaService.updateDisponibilidadAgenda(t.agendaId,!0))).subscribe({next:()=>{this.notificacionesService.mostrarNotificacion("Cita Rechazada","La cita ha sido rechazada y la agenda ha sido actualizada.","warning"),this.obtenerCitasPendientes()},error:e=>{console.error("Error al rechazar la cita:",e),this.notificacionesService.mostrarNotificacion("Error","Ocurri\xF3 un error al rechazar la cita.","error")}})}eliminarCita(t){confirm("\xBFSeguro que quieres eliminar esta cita?")&&this.citasService.deleteCita(Number(t.id)).subscribe({next:()=>{this.notificacionesService.mostrarNotificacion("Cita Eliminada","La cita ha sido eliminada correctamente.","success"),this.obtenerCitasPendientes()},error:e=>{console.error("Error al eliminar cita:",e),this.notificacionesService.mostrarNotificacion("Error","No se pudo eliminar la cita.","error")}})}static \u0275fac=function(e){return new(e||c)(b(ne),b(at),b(ie),b(j),b(A))};static \u0275cmp=v({type:c,selectors:[["app-citas"]],decls:6,vars:3,consts:[[1,"citas-container"],["class","loading",4,"ngIf"],[4,"ngIf"],[1,"loading"],[1,"citas-table"],[4,"ngFor","ngForOf"],[3,"click"],[1,"rechazar",3,"click"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"h2"),r(2,"Solicitudes de Citas Pendientes"),n(),_(3,Qt,2,0,"div",1)(4,Zt,2,0,"div",2)(5,Kt,18,1,"div",2),n()),e&2&&(d(3),s("ngIf",o.loading),d(),s("ngIf",!o.loading&&o.citasPendientes.length===0),d(),s("ngIf",!o.loading&&o.citasPendientes.length>0))},dependencies:[O,w,S],styles:[".citas-container[_ngcontent-%COMP%]{padding:20px;max-width:1000px;margin:auto;box-sizing:border-box}h2[_ngcontent-%COMP%]{margin-bottom:20px;text-align:center}.loading[_ngcontent-%COMP%]{text-align:center;font-style:italic}.citas-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 6px #0000001a}.citas-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .citas-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;text-align:center;font-size:.95rem;word-wrap:break-word;vertical-align:middle}.citas-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f0f0f0;font-weight:600}button[_ngcontent-%COMP%]{margin:0 5px;padding:6px 10px;border:none;border-radius:4px;cursor:pointer;font-size:.9rem;transition:opacity .3s ease;white-space:nowrap}button[_ngcontent-%COMP%]:hover{opacity:.9}button.rechazar[_ngcontent-%COMP%]{background-color:#f44336;color:#fff}button.eliminar[_ngcontent-%COMP%]{background-color:#9e9e9e;color:#fff}@media (max-width: 768px){.citas-table[_ngcontent-%COMP%]{border:0;box-shadow:none}.citas-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.citas-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:block;margin-bottom:1rem;background:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a;padding:1rem}.citas-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:.5rem 0;border:none;border-bottom:1px solid #eee;position:relative;text-align:left;font-size:.9rem}.citas-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-bottom:0;padding-top:.75rem}.citas-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label);flex-basis:40%;font-weight:600;color:#555;padding-right:1rem;white-space:nowrap}button[_ngcontent-%COMP%]{margin:0 3px 0 0;padding:6px 8px;font-size:.85rem}}"]})};var Xt=[{path:"",component:_e,children:[{path:"pacientes",component:he},{path:"medicos",component:ve},{path:"Admin",component:we},{path:"agenda",component:Pe},{path:"historial-citas",component:Se},{path:"solicitudes-citas",component:Ee},{path:"",redirectTo:"pacientes",pathMatch:"full"}]}],lt=class c{static \u0275fac=function(e){return new(e||c)};static \u0275mod=Be({type:c});static \u0275inj=je({imports:[oe.forChild(Xt),oe]})};export{lt as AdminRoutingModule};
